# ETF Analysis Tool

## 개요
이 프로그램은 PyQt6를 기반으로 제작된 ETF 성과 분석 도구입니다. 사용자가 입력한 ETF의 수익률을 분석하고, 벤치마크(KOSPI)와 비교하여 다양한 성과 지표를 계산하며, 구성 종목(PDF)에 대한 기여도 분석을 수행합니다.

## 주요 기능

### 1. 대시보드 (Dashboard)
- **주요 시장 지수 실시간 확인**:
    - KOSPI, KOSDAQ
    - USD/KRW 환율
    - **국채 및 회사채 수익률**: `pykrx`를 통해 국고채 3년물 및 회사채 AA- 수익률을 실시간으로 조회 (0.1bp 단위 정밀도)
- **주의사항 안내**: 해외 지수 추종 국내 ETF 분석 불가 및 외국 지수 분석 기능 안내

### 2. ETF 성과 분석 (ETF Analysis)
- **수익률 분석**: 특정 기간 동안의 ETF 수익률 및 NAV 변화 추적
- **벤치마크 비교**: KOSPI 지수 대비 초과 수익률(Excess Return) 계산
- **위험 조정 성과 지표**:
    - **Sharpe Ratio (샤프 비율)**: 위험 대비 초과 수익
    - **Treynor Ratio (트레이너 지수)**: 체계적 위험(베타) 대비 초과 수익
    - **Excess Return (초과 수익률)**: 벤치마크 대비 수익률 차이
    - *지표 설명 기능 제공 (물음표 버튼 클릭 시 상세 설명 팝업)*

### 3. 구성 종목 분석 (Constituent Analysis)
- **PDF 기여도 분석**: ETF 구성 종목(PDF)의 비중, 평가 금액, 수익률 및 기여도 분석
- **인터랙티브 테이블**:
    - **정렬 기능**: 각 컬럼 헤더 클릭 시 내림차순 -> 오름차순 -> 기본값 순으로 정렬 (3-State Sorting)
    - **읽기 전용**: 데이터 수정 방지
    - **합계 기능**: 테이블에서 여러 행을 선택하면 선택된 항목의 개수와 합계를 하단에 표시
    - **시각적 강조**: 기여도가 0.5% 이상인 경우 붉은색, -0.5% 이하인 경우 파란색 배경으로 강조

### 4. 외국 지수 분석 (Foreign Index Analysis)
- **S&P500 등 해외 지수 추종 ETF 분석**: `yfinance`를 활용하여 해외 지수를 추종하는 ETF의 성과 분석 지원
- **별도 윈도우 제공**: 메인 화면 우측 하단의 버튼을 통해 독립된 분석 창 실행

### 5. 시각화 (Visualization)
- **인터랙티브 차트**: Plotly 기반의 동적 차트 제공
    - **Hover Tooltip**: 마우스 오버 시 정확한 날짜 및 가격 정보 표시
    - **Zoom/Pan**: 차트 확대/축소 및 이동 기능

## 요구 사항
- Python 3.x
- 필수 라이브러리:
  - PyQt6
  - PyQt6-WebEngine
  - pykrx
  - yfinance
  - pandas
  - plotly
  - requests

## 설치 방법
```bash
pip install -r requirements.txt
```

## 사용 방법
1. 프로그램을 실행합니다.
   ```bash
   python main.py
   ```
2. **대시보드**에서 현재 시장 상황을 확인합니다.
3. 분석할 ETF의 **티커(종목 코드)**와 **분석 기간(시작일, 종료일)**을 입력합니다.
   - *참고: 해외 지수 추종 ETF는 우측 하단의 "Foreign Index Analysis" 버튼을 이용하세요.*
4. "분석 (Run Analysis)" 버튼을 클릭하여 분석을 수행합니다.
5. **분석 결과** 화면에서 다음을 확인합니다:
    - 기간 수익률 및 종료일 가격
    - Sharpe/Treynor Ratio 등 성과 지표 (도움말 버튼으로 설명 확인 가능)
    - 인터랙티브 차트를 통한 가격 추이 확인
    - 구성 종목별 기여도 및 상세 정보 (테이블 정렬 및 다중 선택 합계 확인 가능)
